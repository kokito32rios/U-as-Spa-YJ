<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Admin - U√±as Spa Yaneth Jim√©nez</title>
  <link rel="stylesheet" href="/css/styles.css" />
  <link rel="stylesheet" href="/css/dashboard.css" />
</head>

<body>
  <div class="dashboard-container">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>üíÖ Admin Panel</h2>
        <p id="user-welcome">Bienvenid@</p>
      </div>

      <nav class="sidebar-nav">
        <a href="#dashboard" class="nav-item" onclick="cambiarSeccion('dashboard')">
          <span class="nav-icon">üìä</span>
          <span>Dashboard</span>
        </a>
        <a href="#agendamiento" class="nav-item active" onclick="cambiarSeccion('agendamiento')">
          <span class="nav-icon">üìÖ</span>
          <span>Agendamiento</span>
        </a>
        <a href="#agenda" class="nav-item" onclick="cambiarSeccion('agenda')">
          <span class="nav-icon">üóìÔ∏è</span>
          <span>Agenda</span>
        </a>
        <a href="#servicios" class="nav-item" onclick="cambiarSeccion('servicios')">
          <span class="nav-icon">‚ú®</span>
          <span>Servicios</span>
        </a>
        <a href="#usuarios" class="nav-item" onclick="cambiarSeccion('usuarios')">
          <span class="nav-icon">üë•</span>
          <span>Usuarios</span>
        </a>
        <a href="#comisiones" class="nav-item" onclick="cambiarSeccion('comisiones')">
          <span class="nav-icon">üí∞</span>
          <span>Comisiones</span>
        </a>
        <a href="#horarios" class="nav-item" onclick="cambiarSeccion('horarios')">
          <span class="nav-icon">‚è∞</span>
          <span>Horarios</span>
        </a>
        <a href="#galeria" class="nav-item" onclick="cambiarSeccion('galeria')">
          <span class="nav-icon">üñºÔ∏è</span>
          <span>Galer√≠a</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <button class="btn-logout" onclick="cerrarSesion()">
          <span>üö™</span> Cerrar Sesi√≥n
        </button>
      </div>
    </aside>

    <!-- CONTENIDO PRINCIPAL -->
    <main class="main-content">
      <!-- HEADER -->
      <header class="content-header">
        <h1 id="section-title">Gesti√≥n de Agendamiento</h1>
        <div class="header-actions">
          <button class="btn btn-primary" onclick="abrirModalNuevaCita()">
            + Nueva Cita
          </button>
        </div>
      </header>

      <!-- SECCI√ìN: DASHBOARD (NUEVA) -->
      <section id="seccion-dashboard" class="content-section">
        <div class="metrics-grid">
          <!-- Placeholder for future widgets -->
          <div class="metric-card">
            <h3>Pr√≥ximamente</h3>
            <p>Aqu√≠ ver√°s tus estad√≠sticas clave.</p>
          </div>
        </div>
      </section>

      <!-- SECCI√ìN: AGENDAMIENTO -->
      <section id="seccion-agendamiento" class="content-section active">
        <!-- Filtros -->
        <div class="filters-bar">
          <div class="filter-group">
            <label>Fecha:</label>
            <input type="date" id="filtro-fecha" class="filter-input" />
          </div>
          <div class="filter-group">
            <label>Estado:</label>
            <select id="filtro-estado" class="filter-input">
              <option value="">Todos</option>
              <option value="pendiente">Pendiente</option>
              <option value="confirmada">Confirmada</option>
              <option value="completada">Completada</option>
              <option value="cancelada">Cancelada</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Manicurista:</label>
            <select id="filtro-manicurista" class="filter-input">
              <option value="">Todas</option>
            </select>
          </div>
          <button class="btn btn-primary" onclick="aplicarFiltros()">
            Filtrar
          </button>
          <button class="btn-text" onclick="limpiarFiltros()">Limpiar</button>
        </div>

        <!-- Tabla de Citas -->
        <div class="table-container">
          <div id="citas-loader" class="loader-center">
            <div class="spinner"></div>
            <p>Cargando citas...</p>
          </div>

          <table id="tabla-citas" class="data-table hidden">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Hora</th>
                <th>Cliente</th>
                <th>Servicio</th>
                <th>Manicurista</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="citas-tbody">
              <!-- Se llena din√°micamente -->
            </tbody>
          </table>

          <div id="citas-vacio" class="empty-state hidden">
            <p class="empty-icon">üìÖ</p>
            <h3>No hay citas</h3>
            <p>No se encontraron citas con los filtros seleccionados</p>
          </div>
        </div>
      </section>

      <!-- SECCI√ìN: AGENDA (Calendario) -->
      <section id="seccion-agenda" class="content-section">
        <!-- Header de Agenda -->
        <div class="agenda-header">
          <div class="agenda-controles">
            <div class="vista-toggle">
              <button id="btn-vista-semanal" class="btn-toggle active" onclick="cambiarVistaAgenda('semanal')">
                Semanal
              </button>
              <button id="btn-vista-mensual" class="btn-toggle" onclick="cambiarVistaAgenda('mensual')">
                Mensual
              </button>
            </div>
            <div class="navegacion-fecha">
              <button class="btn-nav" onclick="navegarAgenda(-1)">‚óÄ</button>
              <span id="agenda-fecha-titulo">Enero 2026</span>
              <button class="btn-nav" onclick="navegarAgenda(1)">‚ñ∂</button>
              <button class="btn-hoy" onclick="irAHoy()">Hoy</button>
            </div>
          </div>
          <div class="agenda-filtros">
            <label>Manicurista:</label>
            <select id="agenda-filtro-manicurista" class="filter-input" onchange="cargarAgenda()">
              <option value="">Todas</option>
            </select>
          </div>
        </div>

        <!-- Calendario Semanal -->
        <div id="calendario-semanal" class="calendario-container">
          <div id="agenda-loader" class="loader-center">
            <div class="spinner"></div>
            <p>Cargando agenda...</p>
          </div>
          <div id="leyenda-manicuristas-container"></div>
          <div id="calendario-semanal-grid" class="calendario-grid hidden"></div>
        </div>

        <!-- Calendario Mensual -->
        <div id="calendario-mensual" class="calendario-container hidden">
          <div id="calendario-mensual-grid" class="calendario-mensual-grid"></div>
        </div>
      </section>

      <!-- SECCI√ìN: SERVICIOS (Placeholder) -->
      <!-- SECCI√ìN: SERVICIOS -->
      <section id="seccion-servicios" class="content-section">
        <div class="section-header">
          <h3>Gesti√≥n de Servicios</h3>
          <button class="btn btn-primary" onclick="abrirModalServicio()">
            + Nuevo Servicio
          </button>
        </div>

        <div class="table-container">
          <table class="data-table" id="tabla-servicios">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Descripci√≥n</th>
                <th>Precio</th>
                <th>Duraci√≥n</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="servicios-body">
              <!-- Din√°mico -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- SECCI√ìN: HORARIOS -->
      <section id="seccion-horarios" class="content-section">
        <!-- Selector de Manicurista -->
        <div class="horarios-header">
          <div class="form-group">
            <label>Manicurista:</label>
            <select id="horarios-manicurista" class="form-input" onchange="cargarHorarios()">
              <option value="">Seleccionar manicurista</option>
            </select>
          </div>
        </div>

        <!-- Tabla de Horarios Semanales -->
        <div class="horarios-section">
          <div class="section-header">
            <h3>üìÖ Horario Semanal</h3>
            <button class="btn btn-primary btn-sm" onclick="abrirModalHorario()">
              + Agregar D√≠a
            </button>
          </div>
          <div class="table-container">
            <table class="data-table" id="tabla-horarios">
              <thead>
                <tr>
                  <th>D√≠a</th>
                  <th>Hora Inicio</th>
                  <th>Hora Fin</th>
                  <th>Estado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="horarios-body">
                <tr>
                  <td colspan="5" class="text-center">Selecciona una manicurista</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Tabla de Excepciones -->
        <div class="horarios-section">
          <div class="section-header">
            <h3>üö´ D√≠as Bloqueados / Excepciones</h3>
            <button class="btn btn-secondary btn-sm" onclick="abrirModalExcepcion()">
              + Agregar Excepci√≥n
            </button>
          </div>
          <div class="table-container">
            <table class="data-table" id="tabla-excepciones">
              <thead>
                <tr>
                  <th>Fecha</th>
                  <th>Todo el d√≠a</th>
                  <th>Horario</th>
                  <th>Motivo</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="excepciones-body">
                <tr>
                  <td colspan="5" class="text-center">Selecciona una manicurista</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- SECCI√ìN: USUARIOS (Placeholder) -->
      <section id="seccion-usuarios" class="content-section">
        <p>M√≥dulo de Usuarios en desarrollo...</p>
      </section>

      <!-- SECCI√ìN: COMISIONES (Placeholder) -->
      <section id="seccion-comisiones" class="content-section">
        <p>M√≥dulo de Comisiones en desarrollo...</p>
      </section>

      <!-- SECCI√ìN: GALER√çA (Placeholder) -->
      <section id="seccion-galeria" class="content-section">
        <p>M√≥dulo de Galer√≠a en desarrollo...</p>
      </section>
    </main>
  </div>

  <!-- MODAL: NUEVA/EDITAR CITA -->
  <div id="modal-cita" class="modal-overlay hidden">
    <div class="modal-large">
      <div class="modal-header">
        <h3 id="modal-cita-titulo">Nueva Cita</h3>
        <button class="modal-close" onclick="cerrarModalCita()">‚úï</button>
      </div>

      <form id="form-cita" class="modal-body">
        <input type="hidden" id="cita-id" />

        <div class="form-row">
          <div class="form-group">
            <label>Cliente</label>
            <input type="text" id="cita-cliente-search" list="lista-clientes" class="form-input"
              placeholder="Buscar cliente..." autocomplete="off">
            <datalist id="lista-clientes"></datalist>
            <input type="hidden" id="cita-cliente">
          </div>

          <div class="form-group">
            <label>Manicurista *</label>
            <select id="cita-manicurista" class="form-input" required>
              <option value="">Seleccionar manicurista</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group" style="flex: 2;">
            <label>Servicio *</label>
            <select id="cita-servicio" class="form-input" required>
              <option value="">Seleccionar servicio</option>
            </select>
          </div>
          <div class="form-group" style="flex: 1;">
            <label>Precio *</label>
            <input type="number" id="cita-precio" class="form-input" min="0" step="100" required placeholder="0" />
          </div>
          <div class="form-group" style="flex: 0.5;">
            <label>Min *</label>
            <input type="number" id="cita-duracion" class="form-input" min="15" step="15" required />
          </div>
          <div class="form-group" style="flex: 1;">
            <label>Fecha *</label>
            <input type="date" id="cita-fecha" class="form-input" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Hora de Inicio *</label>
            <select id="cita-hora" class="form-input" required disabled>
              <option value="">
                Selecciona manicurista, servicio y fecha
              </option>
            </select>
            <small class="form-help">Primero selecciona manicurista, servicio y fecha</small>
          </div>

          <div class="form-group">
            <label>Estado</label>
            <select id="cita-estado" class="form-input">
              <option value="pendiente">Pendiente</option>
              <option value="confirmada">Confirmada</option>
              <option value="completada">Completada</option>
              <option value="cancelada">Cancelada</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>Notas del Cliente</label>
          <textarea id="cita-notas-cliente" class="form-input" rows="3"></textarea>
        </div>

        <div class="form-group">
          <label>Notas de la Manicurista</label>
          <textarea id="cita-notas-manicurista" class="form-input" rows="3"></textarea>
        </div>
      </form>

      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="cerrarModalCita()">
          Cancelar
        </button>
        <button class="btn btn-primary" onclick="guardarCita()" id="btn-guardar-cita">
          Guardar Cita
        </button>
      </div>
    </div>
  </div>

  <!-- MODAL: MENSAJES -->
  <div id="modal-mensaje" class="modal-overlay hidden">
    <div class="modal-box">
      <div class="modal-icon" id="mensaje-icon"></div>
      <h3 id="mensaje-titulo"></h3>
      <p id="mensaje-texto"></p>
      <button class="btn-modal" onclick="cerrarModalMensaje()">
        Entendido
      </button>
    </div>
  </div>

  <!-- MODAL: CONFIRMACI√ìN -->
  <div id="modal-confirmacion" class="modal-overlay hidden">
    <div class="modal-box">
      <div class="modal-icon-confirm" id="confirm-icon">‚ö†Ô∏è</div>
      <h3 id="confirm-titulo">¬øEst√°s seguro?</h3>
      <p id="confirm-mensaje">Esta acci√≥n no se puede deshacer.</p>
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="cerrarModalConfirmacion()">
          Cancelar
        </button>
        <button class="btn btn-primary" id="btn-confirmar" onclick="ejecutarAccionConfirmada()">
          Confirmar
        </button>
      </div>
    </div>
  </div>

  <!-- MODAL: HORARIO -->
  <div id="modal-horario" class="modal-overlay hidden">
    <div class="modal-content modal-sm">
      <div class="modal-header">
        <h3 id="modal-horario-titulo">Agregar Horario</h3>
        <button class="modal-close" onclick="cerrarModalHorario()">‚úï</button>
      </div>
      <form id="form-horario" class="modal-body">
        <input type="hidden" id="horario-id" />
        <div class="form-group">
          <label>D√≠a de la semana *</label>
          <select id="horario-dia" class="form-input" required>
            <option value="">Seleccionar d√≠a</option>
            <option value="1">Lunes</option>
            <option value="2">Martes</option>
            <option value="3">Mi√©rcoles</option>
            <option value="4">Jueves</option>
            <option value="5">Viernes</option>
            <option value="6">S√°bado</option>
            <option value="7">Domingo</option>
          </select>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Hora Inicio *</label>
            <input type="time" id="horario-inicio" class="form-input" required />
          </div>
          <div class="form-group">
            <label>Hora Fin *</label>
            <input type="time" id="horario-fin" class="form-input" required />
          </div>
        </div>
      </form>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="cerrarModalHorario()">Cancelar</button>
        <button class="btn btn-primary" onclick="guardarHorario()">Guardar</button>
      </div>
    </div>
  </div>

  <!-- MODAL: SERVICIO -->
  <div id="modal-servicio" class="modal-overlay hidden">
    <div class="modal-content modal-sm">
      <div class="modal-header">
        <h3 id="modal-servicio-titulo">Nuevo Servicio</h3>
        <button class="modal-close" onclick="cerrarModalServicio()">‚úï</button>
      </div>
      <form id="form-servicio" class="modal-body">
        <input type="hidden" id="servicio-id" />
        <div class="form-group">
          <label>Nombre del Servicio *</label>
          <input type="text" id="servicio-nombre" class="form-input" required placeholder="Ej: Manicura Tradicional" />
        </div>
        <div class="form-row">
          <div class="form-group" style="flex: 1;">
            <label>Precio *</label>
            <input type="number" id="servicio-precio" class="form-input" required min="0" step="100" />
          </div>
          <div class="form-group" style="flex: 1;">
            <label>Duraci√≥n (min) *</label>
            <input type="number" id="servicio-duracion" class="form-input" required min="15" step="15" />
          </div>
        </div>
        <div class="form-group">
          <label>Descripci√≥n</label>
          <textarea id="servicio-descripcion" class="form-input" rows="2"
            placeholder="Detalles del procedimiento..."></textarea>
        </div>
        <!-- Observaciones removido a pedido -->
      </form>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="cerrarModalServicio()">Cancelar</button>
        <button class="btn btn-primary" onclick="guardarServicio()">Guardar</button>
      </div>
    </div>
  </div>

  <!-- MODAL: EXCEPCI√ìN -->
  <div id="modal-excepcion" class="modal-overlay hidden">
    <div class="modal-content modal-sm">
      <div class="modal-header">
        <h3>Agregar Excepci√≥n</h3>
        <button class="modal-close" onclick="cerrarModalExcepcion()">‚úï</button>
      </div>
      <form id="form-excepcion" class="modal-body">
        <div class="form-group">
          <label>Fecha *</label>
          <input type="date" id="excepcion-fecha" class="form-input" required />
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="excepcion-todo-dia" checked onchange="toggleHorasExcepcion()" />
            Bloquear todo el d√≠a
          </label>
        </div>
        <div id="excepcion-horas" class="form-row hidden">
          <div class="form-group">
            <label>Hora Inicio</label>
            <input type="time" id="excepcion-inicio" class="form-input" />
          </div>
          <div class="form-group">
            <label>Hora Fin</label>
            <input type="time" id="excepcion-fin" class="form-input" />
          </div>
        </div>
        <div class="form-group">
          <label>Motivo</label>
          <input type="text" id="excepcion-motivo" class="form-input" placeholder="Ej: Vacaciones, Cita m√©dica..." />
        </div>
      </form>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="cerrarModalExcepcion()">Cancelar</button>
        <button class="btn btn-primary" onclick="guardarExcepcion()">Guardar</button>
      </div>
    </div>
  </div>

  <script src="/js/dashboard-admin.js"></script>
</body>

</html>